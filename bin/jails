#!/usr/bin/env node

var fs = require("fs"),
    exec = require("child_process").exec;

var version = "0.1";

var template_engine = "jade" /* default */
  , app_name;

var usage = [
    ""
  , "  Usage: jails [command] app_name [options]"
  , ""
  , "  Options:"
  , "    -t, --template <engine>  select template engine (jade|...). default=jade"
  , "    -v, --version            output framework version"
  , "    -h, --help               out help information"
].join("\n");

var jade_layout = [
    "!!!"
  , "html"
  , "  head"
  , "    title= title"
  , "    link(rel=\"stylesheet\", href=\"/stylesheets/style.css\")"
  , "  body!= body"
].join("\n");

var css = "/* this isn't a css framework! =] */\n";

var app = [
    "var jails = require(\"jails\");"
  , ""
  , "var app = module.exports = jails.createServer();"
  , ""
  , "app.listen(3000);"
  , "console.log(\"Listening on port %d\", app.address().port);"
  , ""
].join("\n");

var args = process.argv.slice(2)
  , cmd;

while (args.length) {
  var arg = args.shift();
  switch (arg) {
    /* list commands */
    case "new":
      cmd = create_app;
      break;
    case "-t":
    case "--template":
      // TODO -- check that it is in supported list
      args.length
        ? (template_engine = args.shift())
        : abort("template <engine> required");
      break;
    case "-v":
    case "--version":
      abort(version);
      break;
    case "-h":
    case "--help":
    default:
      abort(usage);
  }
}

var create_app = function() {

}

if (cmd === undefined) {
  abort(usage);
} else if (typeof cmd === "function") {
  cmd();
}
